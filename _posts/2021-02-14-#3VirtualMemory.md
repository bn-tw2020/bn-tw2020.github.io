---
layout: post
title: "가상기억장치 구현 기법"
categories: OS
author: bn-tw2020
---
* content
{:toc}

## Intro

```
가상기억장치는 보조기억장치(하드디스크)의 일부를 주기억장치처럼 사용하는 것으로,
용량이 작은 주기억장치를 마치 큰 용량을 가진 것처럼 사용하는 기법
```




---

## 가상기억장치의 개요

```
1. 프로그램을 여러 개의 작은 블록 단위로 나누어서 가상기억장치에 보관해 놓고,
   프로그램 실행 시 요구되는 블록만 주기억장치에 불연속적으로 할당하여 처리한다.

2. 주기억장치의 용량보다 큰 프로그램을 실행하기 위해 사용한다.

3. 주기억장치의 이용률과 다중 프로그래밍의 효율을 높일 수 있다.

4. 가상기억장치에 저장된 프로그램을 실행하려면 가상기억장치의 주소를 주기억장치의
   주소로 바꾸는 주소 변환 작업이 필요하다.

5. 블록 단위로 나누어 사용하므로 연속 할당 방식에서 발생할 수 있는 단편화를 해결할 수 있다.

6. 가상기억장치의 일반적인 구현 방법에는 블록에 종류에 따라
   페이징 기법과 세그먼테이션 기법을 나눌 수 있다.
```

## 페이징(Paging) 기법

* 페이징 기법은 가상기억장치에 보관되어 있는 프로그램과 주기억장치의 영역을 동일한 크기로
  나눈 후 나눠진 프로그램을 동일하게 나눠진 주기억장치의 영역(페이지 프레임)에 적재시켜 실행하는 기법

```
1. 프로그램을 일정한 크기로 나눈 단위를 페이지라고 하고, 페이지 크기로 일정하게 나누어진
   주기억장치의 단위를 페이지 프레임이라고 한다.

2. 외부 단편화는 발생하지 않으나 내부 단편화는 발생할 수 있다.

3. 주소 변환을 위해서 페이지의 위치 정보를 가지고 있는 페이지 맵 테이블이 필요하다

4. 페이지 맵 테이블 사용으로 비용이 증가되고, 처리 속도가 감소된다.

Question
내부 단편화는 발생할 수 있다??
  >> 페이지 크기가 4KB이고, 사용할 프로그램이 17KB라면, 프로그램은 페이지 단위로 4KB로 나누어지게 된다.
     17KB - 16KB = 1KB가 마지막 페이지 실제용량이 되며,
     1KB를 주기억장치에 적재되면 3KB의 내부 단편화가 발생한다.
```

## 세그먼테이션(Segmentation) 기법

* 세그먼테이션 기법은 가상기억장치에 보관되어 있는 프로그램을 다양한 크기의 논리적인
  단위로 나눈 후 주기억장치에 적재시켜 실행시키는 기법이다.

```
1. 프로그램을 배열이나 함수 등과 같은 논리적인 크기로 나눈 단위를 세그먼트라 하며,
   각 세그먼트는 고유한 이름과 크기를 갖는다.

2. 기억장치의 사용자 관점을 보존하는 기억장치 관리 기법

3. 세그먼테이션 기법을 이요하는 궁극적인 이유는 기억공간을 절약하기 위해서이다.

4. 주소 변환을 위해서 세그먼트가 존재하는 위치 정보를 가지고 있는 세그먼트 맵 테이블이 필요하다.

5. 세그먼트가 주기억장치에 적재될 때 다른 세그먼트에게 할당된 영역을 침벌할 수 없으며,
   이를 위해 기억장치 보호키가 필요하다.

6. 내부 단편화를 발생하지 않으나 외부 단편화는 발생할 수 있다.
```

### 세그먼트 기법의 일반적인 주소 변환

* 주소 형식에 따른 주소와 세그먼트 맵 테이블의 구성

   * 가상 주소
     - 세그먼트 번호를 나타내는 s
     - 세그먼트 내에 실제 내용이 위치하고 있는 곳까지의 거리를 나타내느 변위 값 d
   
   * 실기억주소
     - 완전주소 형태를 사용하며 이는 세그먼트의 기준번지 + 변위 값을 더함으로써 얻을 수 있다.
   
   * 세그먼트 맵 테이블
     - 세그먼트 번호 s
     - 세그먼트의 크기 L
     - 주기억장치 상의 기준번지(시작 주소) b로 구성된다.

```
주소 변환 순서

1. 가상주소의 세그먼트 번호로 세그먼트 맵 테이블에서 해당 세그먼트의 기준번지와 세그먼트 크기를 구한다.
   세그먼트 번호는 세그먼트 맵 테이블에 대한 색인으로 사용된다.

2. 가상주소의 변위값과 세그먼트의 크기를 비교한다.

3. 변위값이 작거나 같으면 기준번지와 변위값을 더하여 실기억주소를 만들어 주기억장치를 액세스 한다.

4. 변위값이 크면 다른 영역을 침범하게 되므로 실행 권한을 운영체제에게 넘기고 트랩을 발생시킨다.
   (변위값이 크다는 것은 현재 찾는 세그먼트의 위치가 해당 세그먼트의 크기를 초과하였다는 의미이다.)
```

<img width="673" alt="스크린샷 2021-02-14 오후 10 35 02" src="https://user-images.githubusercontent.com/66770613/107878296-e233b280-6f14-11eb-9ff3-bb0236df5510.png">
