---
layout: post
title: "TCP(3)"
categories: 네트워크
author: bn-tw2020
---
* content
{:toc}


## Intro

```
네트워크를 정리하는 글입니다.
```





---

## 흐름제어

```
버퍼에서 얼마나 빠른 속도로, 느린 속도로 보내야할까?
결정을 해야하는 근거가 되는 요소는 리시버가 얼마나 받아낼 수 있는지에 대한 능력, 중간에 네트워크 얼마나 데이터를 받아들일 수 있는지에 대한 것이다.

네트워크에 따라 얼마나 붐비는지에 대한 것은 혼잡제어이다.
리시버가 얼마나 받아낼 수있는지에 대한 능력은 흐름제어라고 생각하면 될 것이다.

리시버의 상태에 따라서 보내는 양을 조절하면 된다.
그럼 sender는 어떻게 리시버의 상태를 알고 조절해서 보낼 수 있을까?
받는쪽은 리시버의 버퍼의 남는 공간을 알것이다. 그 정보를 TCP헤더 필드 중 receiver buffer에 적어서 보내주면 알 것이다.

리시버 버퍼가 가득찼다면?
남아있는 공간은 0일 것이다.
TCP 헤더 필드에 적어서 보낼 것이다.
sender는 리시버 버퍼에 남은 공간이 생길 때까지 보내지 않을 것이다.
리시버쪽에서는 보내지 않고 받기만 한다면 sender는 어떻게 리시버 버퍼가 남아있는질 알 수 있을까?
⟹ sender는 리시버에 공간이 없더라도 주기적으로 세그먼트를 날려봅니다.
    세그먼트를 날려봐야 그에 맞는 ACK가 오기 때문이다.

세그먼트를 그럼 데이터를 얼마만큼 쌓아서 보낼까?
어플리케이션계층에서 데이터가 올때마다 보낼까? ⟹ 그럼 세그먼트에 헤더보다 데이터의 크기가 작아서 효율이 없다.
아래와 같은 방법을 이용하고 있다.
   1. 보내는 TCP는 한 바이트라도 있다면 먼저 보낸다.
   2. 그 다음부터는, 세그먼트 내 최대데이터가 다 쌓이거나, 방금 보낸 세그먼트에 대한 ACK를 받을때까지 쌓습니다.
      그 후 보냅니다.
```

> 현재까지 설명은 두개의 프로세스가 TCP연결이 되어있다는 가정하게 이야기를 하였습니다.  
> 다음엔 이렇게 TCP연결이 어떻게 되는지 알아보도록 하겠습니다.